<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1500px" preserveAspectRatio="none" style="width:1157px;height:1500px;" version="1.1" viewBox="0 0 1157 1500" width="1157.2917px" zoomAndPan="magnify"><defs><linearGradient id="g1vr33w9kjnwke0" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#CCCCCC"/></linearGradient><linearGradient id="g1vr33w9kjnwke1" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#F08E41"/><stop offset="100%" stop-color="#EC7211"/></linearGradient></defs><g><rect fill="url(#g1vr33w9kjnwke0)" height="45.0846" id="_title" rx="4.1667" ry="4.1667" style="stroke:#FFFFFF;stroke-width:1.0416666666666667;" width="358.3333" x="397.9167" y="10.4167"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="20.8333" font-weight="bold" lengthAdjust="spacing" textLength="337.5" x="408.3333" y="40.1713">H4x2 2.0 - Tide Sign-up Flow</text><rect fill="#BCC5CE" height="722.168" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="160.9375" y="621.6471"/><rect fill="none" height="222.6563" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="886.4583" x="102.0833" y="166.9271"/><line style="stroke:#ABB6C2;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="165.625" x2="165.625" y1="149.2188" y2="1408.3659"/><line style="stroke:#ABB6C2;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="550" x2="550" y1="149.2188" y2="1408.3659"/><line style="stroke:#ABB6C2;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="710.4167" x2="710.4167" y1="149.2188" y2="1408.3659"/><line style="stroke:#ABB6C2;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="928.125" x2="928.125" y1="149.2188" y2="1408.3659"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="30.2083" x="147.9167" y="141.0624">User</text><ellipse cx="166.1458" cy="70.6055" fill="url(#g1vr33w9kjnwke1)" rx="8.3333" ry="8.3333" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><path d="M166.1458,78.9388 L166.1458,107.0638 M152.6042,87.2721 L179.6875,87.2721 M166.1458,107.0638 L152.6042,122.6888 M166.1458,107.0638 L179.6875,122.6888 " fill="none" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="30.2083" x="147.9167" y="1424.1353">User</text><ellipse cx="166.1458" cy="1441.1458" fill="url(#g1vr33w9kjnwke1)" rx="8.3333" ry="8.3333" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><path d="M166.1458,1449.4792 L166.1458,1477.6042 M152.6042,1457.8125 L179.6875,1457.8125 M166.1458,1477.6042 L152.6042,1493.2292 M166.1458,1477.6042 L179.6875,1493.2292 " fill="none" style="stroke:#EC7211;stroke-width:0.5208333333333334;"/><rect fill="url(#g1vr33w9kjnwke1)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="71.875" x="514.5833" y="108.6263"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="46.875" x="527.0833" y="132.7291">Vendor</text><rect fill="url(#g1vr33w9kjnwke1)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="71.875" x="514.5833" y="1407.3242"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="46.875" x="527.0833" y="1431.427">Vendor</text><rect fill="url(#g1vr33w9kjnwke1)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="57.2917" x="684.375" y="104.4596"/><rect fill="url(#g1vr33w9kjnwke1)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="57.2917" x="680.2083" y="108.6263"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="32.2917" x="692.7083" y="132.7291">ORKs</text><rect fill="url(#g1vr33w9kjnwke1)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="57.2917" x="684.375" y="1407.3242"/><rect fill="url(#g1vr33w9kjnwke1)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#EC7211;stroke-width:0.5208333333333334;" width="57.2917" x="680.2083" y="1411.4909"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="32.2917" x="692.7083" y="1435.5937">ORKs</text><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="61.4583" x="894.7917" y="141.0624">Simulator</text><path d="M909.8958,86.7513 C909.8958,76.3346 928.6458,76.3346 928.6458,76.3346 C928.6458,76.3346 947.3958,76.3346 947.3958,86.7513 L947.3958,113.8346 C947.3958,124.2513 928.6458,124.2513 928.6458,124.2513 C928.6458,124.2513 909.8958,124.2513 909.8958,113.8346 L909.8958,86.7513 " fill="url(#g1vr33w9kjnwke1)" style="stroke:#EC7211;stroke-width:1.5625;"/><path d="M909.8958,86.7513 C909.8958,97.168 928.6458,97.168 928.6458,97.168 C928.6458,97.168 947.3958,97.168 947.3958,86.7513 " fill="none" style="stroke:#EC7211;stroke-width:1.5625;"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="61.4583" x="894.7917" y="1424.1353">Simulator</text><path d="M909.8958,1442.7083 C909.8958,1432.2917 928.6458,1432.2917 928.6458,1432.2917 C928.6458,1432.2917 947.3958,1432.2917 947.3958,1442.7083 L947.3958,1469.7917 C947.3958,1480.2083 928.6458,1480.2083 928.6458,1480.2083 C928.6458,1480.2083 909.8958,1480.2083 909.8958,1469.7917 L909.8958,1442.7083 " fill="url(#g1vr33w9kjnwke1)" style="stroke:#EC7211;stroke-width:1.5625;"/><path d="M909.8958,1442.7083 C909.8958,1453.125 928.6458,1453.125 928.6458,1453.125 C928.6458,1453.125 947.3958,1453.125 947.3958,1442.7083 " fill="none" style="stroke:#EC7211;stroke-width:1.5625;"/><rect fill="#BCC5CE" height="722.168" style="stroke:#ABB6C2;stroke-width:1.0416666666666667;" width="10.4167" x="160.9375" y="621.6471"/><path d="M106.25,166.9271 L253.125,166.9271 L253.125,183.5612 L242.7083,193.9779 L102.0833,193.9779 L102.0833,171.0938 A4.1667,4.1667 0 0 1 106.25,166.9271 " fill="#FFFFFF" style="stroke:#4E5D6C;stroke-width:1.5625;"/><rect fill="none" height="222.6563" rx="4.1667" ry="4.1667" style="stroke:#4E5D6C;stroke-width:1.5625;" width="886.4583" x="102.0833" y="166.9271"/><text fill="#0073BB" font-family="&quot;Verdana&quot;" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="93.75" x="122.9167" y="184.7799">Precondition</text><path d="M112.5,203.3529 L112.5,258.5612 A4.1667,4.1667 0 0 0 116.6667,262.7279 L215.625,262.7279 A4.1667,4.1667 0 0 0 219.7917,258.5612 L219.7917,209.6029 L209.375,199.1862 L116.6667,199.1862 A4.1667,4.1667 0 0 0 112.5,203.3529 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M209.375,199.1862 L209.375,207.5195 A2.0833,2.0833 0 0 0 211.4583,209.6029 L219.7917,209.6029 L209.375,199.1862 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="65.625" x="123.9583" y="221.2056">username</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="62.5" x="123.9583" y="235.7564">password</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="75" x="123.9583" y="250.3072">secretCode</text><path d="M623.9583,278.2552 L623.9583,318.8802 A4.1667,4.1667 0 0 0 628.125,323.0469 L792.7083,323.0469 A4.1667,4.1667 0 0 0 796.875,318.8802 L796.875,284.5052 L786.4583,274.0885 L628.125,274.0885 A4.1667,4.1667 0 0 0 623.9583,278.2552 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M786.4583,274.0885 L786.4583,282.4219 A2.0833,2.0833 0 0 0 788.5417,284.5052 L796.875,284.5052 L786.4583,274.0885 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="47.9167" x="635.4167" y="296.108">ORKPriv</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="140.625" x="635.4167" y="310.6588">ORKPub = G * ORKPriv</text><path d="M878.125,338.6068 L878.125,379.2318 A4.1667,4.1667 0 0 0 882.2917,383.3984 L973.9583,383.3984 A4.1667,4.1667 0 0 0 978.125,379.2318 L978.125,344.8568 L967.7083,334.4401 L882.2917,334.4401 A4.1667,4.1667 0 0 0 878.125,338.6068 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M967.7083,334.4401 L967.7083,342.7734 A2.0833,2.0833 0 0 0 969.7917,344.8568 L978.125,344.8568 L967.7083,334.4401 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="67.7083" x="889.5833" y="356.4596">ORK Public</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="53.125" x="889.5833" y="371.0103">ORK URL</text><polygon fill="#EC7211" points="538.0208,423.9258,548.4375,428.0924,538.0208,432.2591,542.1875,428.0924" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="166.1458" x2="544.2708" y1="428.0924" y2="428.0924"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="152.0833" x="178.6458" y="417.8528">GET Vendor Login Page</text><polygon fill="#EC7211" points="177.6042,463.4766,167.1875,467.6432,177.6042,471.8099,173.4375,467.6432" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="171.3542" x2="549.4792" y1="467.6432" y2="467.6432"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="348.9583" x="189.0625" y="457.4036">Redirect to ORK enclave (specifcally Tide ORK for now)</text><polygon fill="#EC7211" points="916.1458,503.0273,926.5625,507.194,916.1458,511.3607,920.3125,507.194" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="166.1458" x2="922.3958" y1="507.194" y2="507.194"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="167.7083" x="178.6458" y="496.9543">Get All Available ORK URLs</text><path d="M65.625,524.9023 L65.625,580.1107 A4.1667,4.1667 0 0 0 69.7917,584.2773 L262.5,584.2773 A4.1667,4.1667 0 0 0 266.6667,580.1107 L266.6667,531.1523 L256.25,520.7357 L69.7917,520.7357 A4.1667,4.1667 0 0 0 65.625,524.9023 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M256.25,520.7357 L256.25,529.069 A2.0833,2.0833 0 0 0 258.3333,531.1523 L266.6667,531.1523 L256.25,520.7357 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="133.3333" x="77.0833" y="542.7551">a = Point(password)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="168.75" x="77.0833" y="557.3059">userID = hash(username)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="84.375" x="77.0833" y="571.8567">r = random()</text><polygon fill="#EC7211" points="698.4375,617.4805,708.8542,621.6471,698.4375,625.8138,702.6042,621.6471" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="171.3542" x2="704.6875" y1="621.6471" y2="621.6471"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="78.125" x="183.8542" y="611.4075">a * r, userID</text><polygon fill="#EC7211" points="916.1458,657.0313,926.5625,661.1979,916.1458,665.3646,920.3125,661.1979" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="710.9375" x2="922.3958" y1="661.1979" y2="661.1979"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="182.2917" x="723.4375" y="650.9583">Check userID does not exist</text><path d="M532.2917,678.9063 L532.2917,719.5313 A4.1667,4.1667 0 0 0 536.4583,723.6979 L885.4167,723.6979 A4.1667,4.1667 0 0 0 889.5833,719.5313 L889.5833,685.1563 L879.1667,674.7396 L536.4583,674.7396 A4.1667,4.1667 0 0 0 532.2917,678.9063 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M879.1667,674.7396 L879.1667,683.0729 A2.0833,2.0833 0 0 0 881.25,685.1563 L889.5833,685.1563 L879.1667,674.7396 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="114.5833" x="543.75" y="696.759">Prism = random()</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="325" x="543.75" y="711.3098">EncryptedState = Encrypt(Prism | userID, ORKPriv)</text><polygon fill="#EC7211" points="182.8125,756.9336,172.3958,761.1003,182.8125,765.2669,178.6458,761.1003" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="176.5625" x2="709.8958" y1="761.1003" y2="761.1003"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="245.8333" x="194.2708" y="750.8606">a * r * Prism, EncryptedState, ORKPub</text><path d="M5.2083,778.8086 L5.2083,834.0169 A4.1667,4.1667 0 0 0 9.375,838.1836 L322.9167,838.1836 A4.1667,4.1667 0 0 0 327.0833,834.0169 L327.0833,785.0586 L316.6667,774.6419 L9.375,774.6419 A4.1667,4.1667 0 0 0 5.2083,778.8086 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M316.6667,774.6419 L316.6667,782.9753 A2.0833,2.0833 0 0 0 318.75,785.0586 L327.0833,785.0586 L316.6667,774.6419 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="281.25" x="16.6667" y="796.6614">keyPoint = (a * r * Prism) * r^-1  (remove r)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="201.0417" x="16.6667" y="811.2122">PrismPub = G * hash(keyPoint)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="289.5833" x="16.6667" y="825.7629">PrismAuth = hash(ORKPub * hash(keyPoint))</text><polygon fill="#EC7211" points="698.4375,871.3867,708.8542,875.5534,698.4375,879.7201,702.6042,875.5534" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="171.3542" x2="704.6875" y1="875.5534" y2="875.5534"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="169.7917" x="183.8542" y="865.3137">PrismPub, EncryptedState</text><path d="M561.4583,893.2617 L561.4583,919.3034 A4.1667,4.1667 0 0 0 565.625,923.4701 L855.2083,923.4701 A4.1667,4.1667 0 0 0 859.375,919.3034 L859.375,899.5117 L848.9583,889.0951 L565.625,889.0951 A4.1667,4.1667 0 0 0 561.4583,893.2617 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M848.9583,889.0951 L848.9583,897.4284 A2.0833,2.0833 0 0 0 851.0417,899.5117 L859.375,899.5117 L848.9583,889.0951 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="265.625" x="572.9167" y="911.1145">Prism, userID = Decrypt(EncryptedState)</text><path d="M561.4583,939.0625 L561.4583,1023.4375 A4.1667,4.1667 0 0 0 565.625,1027.6042 L855.2083,1027.6042 A4.1667,4.1667 0 0 0 859.375,1023.4375 L859.375,945.3125 L848.9583,934.8958 L565.625,934.8958 A4.1667,4.1667 0 0 0 561.4583,939.0625 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M848.9583,934.8958 L848.9583,943.2292 A2.0833,2.0833 0 0 0 851.0417,945.3125 L859.375,945.3125 L848.9583,934.8958 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="103.125" x="572.9167" y="956.9153">CVK = random()</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="258.3333" x="572.9167" y="971.4661">PrismAuth = hash( ORKPriv * PrismPub )</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="265.625" x="572.9167" y="986.0168">EncryptedCVK = Encrypt(CVK, PrismAuth)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="221.875" x="572.9167" y="1000.5676">SignedUID = Sign(userID, ORKPriv)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="237.5" x="572.9167" y="1015.1184">Store(PrismAuth, userID, Prism, CVK)</text><polygon fill="#EC7211" points="182.8125,1060.7422,172.3958,1064.9089,182.8125,1069.0755,178.6458,1064.9089" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="176.5625" x2="709.8958" y1="1064.9089" y2="1064.9089"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="164.5833" x="194.2708" y="1054.6692">EncryptedCVK, SignedUID</text><path d="M7.2917,1082.6172 L7.2917,1137.8255 A4.1667,4.1667 0 0 0 11.4583,1141.9922 L320.8333,1141.9922 A4.1667,4.1667 0 0 0 325,1137.8255 L325,1088.8672 L314.5833,1078.4505 L11.4583,1078.4505 A4.1667,4.1667 0 0 0 7.2917,1082.6172 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M314.5833,1078.4505 L314.5833,1086.7839 A2.0833,2.0833 0 0 0 316.6667,1088.8672 L325,1088.8672 L314.5833,1078.4505 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="266.6667" x="18.75" y="1100.47">CVK = Decrypt(EncryptedCVK, PrismAuth)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="285.4167" x="18.75" y="1115.0208">EncryptedCode = Encrypt(SecretCode, CVK)</text><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="210.4167" x="18.75" y="1129.5715">SignedEntry = Sum( SignedUID )</text><polygon fill="#EC7211" points="916.1458,1175.1953,926.5625,1179.362,916.1458,1183.5286,920.3125,1179.362" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="171.3542" x2="922.3958" y1="1179.362" y2="1179.362"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="196.875" x="183.8542" y="1169.1223">userID, SignedEntry, ORK URLs</text><path d="M706.25,1197.0703 L706.25,1223.112 A4.1667,4.1667 0 0 0 710.4167,1227.2786 L1145.8333,1227.2786 A4.1667,4.1667 0 0 0 1150,1223.112 L1150,1203.3203 L1139.5833,1192.9036 L710.4167,1192.9036 A4.1667,4.1667 0 0 0 706.25,1197.0703 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M1139.5833,1192.9036 L1139.5833,1201.237 A2.0833,2.0833 0 0 0 1141.6667,1203.3203 L1150,1203.3203 L1139.5833,1192.9036 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="411.4583" x="717.7083" y="1214.9231">Verify SignedEntry was signed by all ORKs specified in ORK URLs</text><polygon fill="#EC7211" points="182.8125,1260.5469,172.3958,1264.7135,182.8125,1268.8802,178.6458,1264.7135" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="176.5625" x2="927.6042" y1="1264.7135" y2="1264.7135"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="86.4583" x="194.2708" y="1254.4739">Confirm entry</text><polygon fill="#EC7211" points="538.0208,1300.0977,548.4375,1304.2643,538.0208,1308.431,542.1875,1304.2643" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="171.3542" x2="544.2708" y1="1304.2643" y2="1304.2643"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="148.9583" x="183.8542" y="1294.0247">EncryptedCode, userID</text><polygon fill="#EC7211" points="916.1458,1339.6484,926.5625,1343.8151,916.1458,1347.9818,920.3125,1343.8151" style="stroke:#EC7211;stroke-width:1.0416666666666667;"/><line style="stroke:#EC7211;stroke-width:3.125;" x1="550.5208" x2="922.3958" y1="1343.8151" y2="1343.8151"/><text fill="#4E5D6C" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="114.5833" x="563.0208" y="1333.5754">Check user exists</text><path d="M436.4583,1361.5234 L436.4583,1387.5651 A4.1667,4.1667 0 0 0 440.625,1391.7318 L659.375,1391.7318 A4.1667,4.1667 0 0 0 663.5417,1387.5651 L663.5417,1367.7734 L653.125,1357.3568 L440.625,1357.3568 A4.1667,4.1667 0 0 0 436.4583,1361.5234 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><path d="M653.125,1357.3568 L653.125,1365.6901 A2.0833,2.0833 0 0 0 655.2083,1367.7734 L663.5417,1367.7734 L653.125,1357.3568 " fill="#0073BB" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="&quot;Verdana&quot;" font-size="12.5" lengthAdjust="spacing" textLength="194.7917" x="447.9167" y="1379.3762">Store(EncryptedCode, userID)</text><!--MD5=[f374cd07c08a7b4209537a7322d74a5e]
@startuml H4x2_prism
title H4x2 2.0 - Tide Sign-up Flow
!include https://raw.githubusercontent.com/bschwarz/puml-themes/master/themes/aws-orange-light/puml-theme-aws-orange-light.puml

actor "User" as usr
participant "Vendor" as vendor
collections "ORKs" as ork
database "Simulator" as sim

group Precondition
note over usr
    username
    password
    secretCode
end note 

note over ork
    ORKPriv
    ORKPub = G * ORKPriv
end note

note over sim
    ORK Public
    ORK URL
end note
end

usr -> vendor: GET Vendor Login Page
vendor -> usr: Redirect to ORK enclave (specifcally Tide ORK for now)
usr -> sim: Get All Available ORK URLs

note over usr
a = Point(password)
userID = hash(username)
r = random()
endnote

usr -> ork: a * r, userID
activate usr

ork -> sim: Check userID does not exist
note over ork
Prism = random()
EncryptedState = Encrypt(Prism | userID, ORKPriv)
endnote
ork -> usr: a * r * Prism, EncryptedState, ORKPub

note over usr
keyPoint = (a * r * Prism) * r^-1  (remove r)
PrismPub = G * hash(keyPoint)
PrismAuth = hash(ORKPub * hash(keyPoint))
endnote

usr -> ork: PrismPub, EncryptedState
note over ork
Prism, userID = Decrypt(EncryptedState)
end note

note over ork
CVK = random()
PrismAuth = hash( ORKPriv * PrismPub )
EncryptedCVK = Encrypt(CVK, PrismAuth)
SignedUID = Sign(userID, ORKPriv)
Store(PrismAuth, userID, Prism, CVK)
endnote

ork -> usr: EncryptedCVK, SignedUID

note over usr
CVK = Decrypt(EncryptedCVK, PrismAuth)
EncryptedCode = Encrypt(SecretCode, CVK)
SignedEntry = Sum( SignedUID )
end note

usr -> sim: userID, SignedEntry, ORK URLs
note over sim
Verify SignedEntry was signed by all ORKs specified in ORK URLs
end note
sim -> usr: Confirm entry
usr -> vendor: EncryptedCode, userID
vendor -> sim: Check user exists

note over vendor
Store(EncryptedCode, userID)
end note
deactivate usr

@enduml

@startuml H4x2_prism
title H4x2 2.0 - Tide Sign-up Flow



skinparam backgroundColor transparent










skinparam defaultFontName       "Verdana"
skinparam defaultFontSize       12
skinparam dpi                   100
skinparam shadowing             false
skinparam roundcorner           8
skinparam ParticipantPadding    40
skinparam BoxPadding            40
skinparam Padding               5
skinparam ArrowColor            #4E5D6C
skinparam stereotype {
    CBackgroundColor #ffffff
    CBorderColor #cccccc
    ABackgroundColor #4a9a35
    ABorderColor #176702
    IBackgroundColor #da5b41
    IBorderColor #a7280e
    EBackgroundColor #f08e41
    EBorderColor #bd5b0e
    NBackgroundColor #338fc9
    NBorderColor #005c96
}
skinparam title {
	FontColor	                 #4E5D6C
	BorderColor	                 #FFFFFF
	FontSize	    	         20
	BorderRoundCorner            8
	BorderThickness 	         1
	BackgroundColor              #FFFFFF-#cccccc
}

skinparam legend {
	BackgroundColor #FFFFFF
	BorderColor #cccccc
	FontColor #abb6c2
}

skinparam swimlane {
	BorderColor #0073bb
	BorderThickness 2
	TitleBackgroundColor  #FFFFFF-#cccccc
	TitleFontColor #EC7211
}


skinparam activity {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	BarColor #1D8102
	StartColor #0073bb
	EndColor #0073bb
	DiamondBackgroundColor #ffffff
  	DiamondBorderColor #cccccc
  	DiamondFontColor #4E5D6C
}

skinparam participant {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	ParticipantBorderThickness 2
}

skinparam actor {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam arrow {
	Thickness 3
	Color #EC7211
	FontColor #4E5D6C
}

skinparam sequence {
	ArrowThickness 3
	BorderColor #EC7211
	TitleFontColor #EC7211
	BackgroundColor transparent
	StartColor #EC7211
	EndColor #EC7211
	BoxBackgroundColor transparent
	BoxBorderColor #4E5D6C
	BoxFontColor #4E5D6C
	DelayFontColor #4E5D6C
	LifeLineBorderColor #abb6c2
	LifeLineBorderThickness 2
	LifeLineBackgroundColor #bcc5ce
	GroupBorderColor #4E5D6C
	GroupFontColor #4E5D6C
	GroupHeaderFontColor #0073bb
	GroupBackgroundColor #FFFFFF
	GroupBodyBackgroundColor transparent
	GroupHeaderBackgroundColor transparent
	DividerBackgroundColor #4E5D6C
    DividerBorderColor #4E5D6C
    DividerBorderThickness 2
    DividerFontColor #abb6c2
	ReferenceBackgroundColor transparent
	ReferenceBorderColor #4E5D6C
	ReferenceFontColor #4E5D6C
	ReferenceHeaderFontColor #0073bb
	ReferenceHeaderBackgroundColor #FFFFFF
	StereotypeFontColor #FFF
}

skinparam partition {
	BorderColor #EC7211
	FontColor #EC7211
	BackgroundColor transparent
}

skinparam collections {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}

skinparam control {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam entity {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam boundary {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam agent {
	BackgroundColor #EC7211
	BorderColor #f08e41
	FontColor #4E5D6C
}

skinparam note {
	BorderThickness 1
	BackgroundColor #0073bb
	BorderColor #005c96
	FontColor #FFF
}

skinparam artifact {
	BackgroundColor #4E5D6C
	BorderColor #717d89
	FontColor #abb6c2
}

skinparam component {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}

skinparam interface {
	BackgroundColor  #a7280e
	BorderColor  #d13212
	FontColor #4E5D6C
}

skinparam storage {
	BackgroundColor #EC7211
  	BorderColor #bd5b0e
	FontColor #FFF
}

skinparam node {
	BackgroundColor  transparent
	BorderColor #abb6c2
	FontColor #abb6c2
}

skinparam cloud {
	BackgroundColor transparent
	BorderColor #4E5D6C
	FontColor #abb6c2
}

skinparam database {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	FontColor #4E5D6C
}

skinparam class {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	HeaderBackgroundColor #f08e41
	StereotypeFontColor #4E5D6C
	BorderThickness 1
	AttributeFontColor #FFF
	AttributeFontSize 11
}

skinparam object {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	StereotypeFontColor #4E5D6C
	BorderThickness 1
	AttributeFontColor #FFF
	AttributeFontSize 11
}

skinparam usecase {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	BorderThickness 2
	StereotypeFontColor #EC7211
}

skinparam rectangle {
	BackgroundColor transparent
	FontColor #4E5D6C
	BorderColor #4E5D6C
	BorderThickness 2
	StereotypeFontColor #abb6c2
}

skinparam package {
	BackgroundColor #FFFFFF
  	BorderColor #4E5D6C
	FontColor #4E5D6C
	BorderThickness 2
}

skinparam folder {
	BackgroundColor #ffffff
  	BorderColor #EC7211
	FontColor #EC7211
	BorderThickness 2
}

skinparam frame {
	BackgroundColor #ffffff
  	BorderColor #0073bb
	FontColor #0073bb
	BorderThickness 2
}

skinparam state {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
	StartColor #0073bb
	EndColor #0073bb
	AttributeFontColor #4E5D6C
	AttributeFontSize 11
}

skinparam queue {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}

skinparam card {
	BackgroundColor #0073bb
	BorderColor #005c96
	FontColor #FFF
}

skinparam file {
	BackgroundColor #cccccc
	BorderColor #abb6c2
	FontColor #4E5D6C
}


skinparam stack {
		FontColor #FFF
	BorderColor #EC7211
	BackgroundColor #f08e41-#EC7211
}


actor "User" as usr
participant "Vendor" as vendor
collections "ORKs" as ork
database "Simulator" as sim

group Precondition
note over usr
    username
    password
    secretCode
end note 

note over ork
    ORKPriv
    ORKPub = G * ORKPriv
end note

note over sim
    ORK Public
    ORK URL
end note
end

usr -> vendor: GET Vendor Login Page
vendor -> usr: Redirect to ORK enclave (specifcally Tide ORK for now)
usr -> sim: Get All Available ORK URLs

note over usr
a = Point(password)
userID = hash(username)
r = random()
endnote

usr -> ork: a * r, userID
activate usr

ork -> sim: Check userID does not exist
note over ork
Prism = random()
EncryptedState = Encrypt(Prism | userID, ORKPriv)
endnote
ork -> usr: a * r * Prism, EncryptedState, ORKPub

note over usr
keyPoint = (a * r * Prism) * r^-1  (remove r)
PrismPub = G * hash(keyPoint)
PrismAuth = hash(ORKPub * hash(keyPoint))
endnote

usr -> ork: PrismPub, EncryptedState
note over ork
Prism, userID = Decrypt(EncryptedState)
end note

note over ork
CVK = random()
PrismAuth = hash( ORKPriv * PrismPub )
EncryptedCVK = Encrypt(CVK, PrismAuth)
SignedUID = Sign(userID, ORKPriv)
Store(PrismAuth, userID, Prism, CVK)
endnote

ork -> usr: EncryptedCVK, SignedUID

note over usr
CVK = Decrypt(EncryptedCVK, PrismAuth)
EncryptedCode = Encrypt(SecretCode, CVK)
SignedEntry = Sum( SignedUID )
end note

usr -> sim: userID, SignedEntry, ORK URLs
note over sim
Verify SignedEntry was signed by all ORKs specified in ORK URLs
end note
sim -> usr: Confirm entry
usr -> vendor: EncryptedCode, userID
vendor -> sim: Check user exists

note over vendor
Store(EncryptedCode, userID)
end note
deactivate usr

@enduml

PlantUML version 1.2022.13(Sat Nov 19 13:22:17 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>